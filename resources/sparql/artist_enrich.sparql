SELECT
  ?artist
  (SAMPLE(?artistLabelRaw) AS ?artistLabel)
  (SAMPLE(?artistDescriptionRaw) AS ?artistDescription)

  # Multi-valued: join them so you can parse once per artist
  (GROUP_CONCAT(DISTINCT STR(?instanceOf); SEPARATOR="|") AS ?instanceOf)
  (GROUP_CONCAT(DISTINCT STR(?genre); SEPARATOR="|") AS ?genre)

  (SAMPLE(?country) AS ?country)
  (SAMPLE(?countryLabelRaw) AS ?countryLabel)

  (SAMPLE(?officialWebsite) AS ?officialWebsite)
  (SAMPLE(?wikipediaUrl) AS ?wikipediaUrl)

  (SAMPLE(?imageCommons) AS ?imageCommons)
  (SAMPLE(?logoCommons) AS ?logoCommons)
  (SAMPLE(?commonsCategory) AS ?commonsCategory)

  (SAMPLE(?formed) AS ?formed)
  (SAMPLE(?disbanded) AS ?disbanded)

  (SAMPLE(?musicBrainzId) AS ?musicBrainzId)

  (SAMPLE(?givenNameLabelRaw) AS ?givenNameLabel)
  (SAMPLE(?familyNameLabelRaw) AS ?familyNameLabel)

  (SAMPLE(?twitter) AS ?twitter)
  (SAMPLE(?instagram) AS ?instagram)
  (SAMPLE(?facebook) AS ?facebook)
  (SAMPLE(?youtubeChannel) AS ?youtubeChannel)
  (SAMPLE(?spotifyArtistId) AS ?spotifyArtistId)
  (SAMPLE(?appleMusicArtistId) AS ?appleMusicArtistId)
  (SAMPLE(?deezerArtistId) AS ?deezerArtistId)
  (SAMPLE(?soundcloudId) AS ?soundcloudId)
  (SAMPLE(?bandcampId) AS ?bandcampId)
  (SAMPLE(?subreddit) AS ?subreddit)
WHERE {
  VALUES ?artist { {{values}} }

  # Explicit label/description fetching (wikibase:label doesn't work reliably with GROUP BY)
  OPTIONAL { ?artist rdfs:label ?artistLabelRaw . FILTER(LANG(?artistLabelRaw) = "en") }
  OPTIONAL { ?artist schema:description ?artistDescriptionRaw . FILTER(LANG(?artistDescriptionRaw) = "en") }

  OPTIONAL { ?artist wdt:P31 ?instanceOf . }

  # Country: origin for groups, citizenship for people; coalesce
  OPTIONAL { ?artist wdt:P495 ?countryOrigin . }
  OPTIONAL { ?artist wdt:P27  ?countryCitizen . }
  BIND(COALESCE(?countryOrigin, ?countryCitizen) AS ?country)
  OPTIONAL { ?country rdfs:label ?countryLabelRaw . FILTER(LANG(?countryLabelRaw) = "en") }

  OPTIONAL { ?artist wdt:P856 ?officialWebsite . }

  OPTIONAL { ?artist wdt:P18  ?imageCommons . }
  OPTIONAL { ?artist wdt:P154 ?logoCommons . }
  OPTIONAL { ?artist wdt:P373 ?commonsCategory . }

  OPTIONAL { ?artist wdt:P571 ?formed . }
  OPTIONAL { ?artist wdt:P576 ?disbanded . }

  OPTIONAL { ?artist wdt:P434 ?musicBrainzId . }
  OPTIONAL { ?artist wdt:P136 ?genre . }

  OPTIONAL {
    ?artist wdt:P735 ?givenName .
    ?givenName rdfs:label ?givenNameLabelRaw . FILTER(LANG(?givenNameLabelRaw) = "en")
  }
  OPTIONAL {
    ?artist wdt:P734 ?familyName .
    ?familyName rdfs:label ?familyNameLabelRaw . FILTER(LANG(?familyNameLabelRaw) = "en")
  }

  OPTIONAL { ?artist wdt:P2002 ?twitter . }
  OPTIONAL { ?artist wdt:P2003 ?instagram . }
  OPTIONAL { ?artist wdt:P2013 ?facebook . }
  OPTIONAL { ?artist wdt:P2397 ?youtubeChannel . }
  OPTIONAL { ?artist wdt:P1902 ?spotifyArtistId . }
  OPTIONAL { ?artist wdt:P2850 ?appleMusicArtistId . }
  OPTIONAL { ?artist wdt:P2722 ?deezerArtistId . }
  OPTIONAL { ?artist wdt:P3040 ?soundcloudId . }
  OPTIONAL { ?artist wdt:P3283 ?bandcampId . }
  OPTIONAL { ?artist wdt:P3984 ?subreddit . }

  OPTIONAL {
    ?wikipediaUrl schema:about ?artist ;
                  schema:isPartOf <https://en.wikipedia.org/> .
  }
}
GROUP BY ?artist
