# Incremental discovery of CHANGED genre entities since a timestamp
# Used by weekly incremental sync to find genres modified since last run

PREFIX schema: <http://schema.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT DISTINCT ?genre ?modified WHERE {
  ?genre wdt:P31 wd:Q188451 .

  # Get modification timestamp
  ?genre schema:dateModified ?modified .

  # Filter by since timestamp
  FILTER(?modified > "{{since}}"^^xsd:dateTime)
  {{after_modified_filter}}
}
ORDER BY ?modified
LIMIT {{limit}}
